extern func malloc(size: usize): *void
extern func free(ptr: *void)

interface Allocator
    func alloc(size: usize): *byte
end

struct ArenaAllocator
    data: *byte
    size: usize
    offset: usize

    func alloc(size: usize): *byte
        var ptr = self.data + self.offset
        self.offset += size
        return ptr
    end

    func release()
        free(self.data)
    end
end

func create_arena(size: usize): ArenaAllocator
    var data = malloc(size) as *byte
    return ArenaAllocator(data = data, size = 0, offset = 0)
end

func main(): int
    with var arena = create_arena(1024)
        var data = arena.alloc(16)
    end
    return 0
end
